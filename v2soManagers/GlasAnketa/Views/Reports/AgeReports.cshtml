@model List<AgeReportVM>

@{
    ViewData["Title"] = "Age Reports";
}

<div class="reports-container">
    <div class="report-header">
        <div class="header-content">
            <h1>üßë‚Äçü§ù‚Äçüßë Age Reports</h1>
            <p>Responses and averages grouped by age buckets</p>
        </div>
        <a href="@Url.Action("Index", "Reports")" class="btn btn-back">‚Üê Back</a>
    </div>
    <div class="filter-bar">
        <form method="get" action="@Url.Action("AgeReports", "Reports")" class="filter-form">
            <label for="ageRange">Age Range:</label>
            <select id="ageRange" name="ageRange">
                @{ var selected = Context.Request.Query["ageRange"].ToString(); }
                <option value="" selected="@(string.IsNullOrEmpty(selected) ? "selected" : null)">All</option>
                <option value="< 25" selected="@(selected == "< 25" ? "selected" : null)">&lt; 25</option>
                <option value="25 - 30" selected="@(selected == "25 - 30" ? "selected" : null)">25 - 30</option>
                <option value="31 - 40" selected="@(selected == "31 - 40" ? "selected" : null)">31 - 40</option>
                <option value="41 - 50" selected="@(selected == "41 - 50" ? "selected" : null)">41 - 50</option>
                <option value="> 50" selected="@(selected == "> 50" ? "selected" : null)">&gt; 50</option>
            </select>
            <button type="submit" class="btn btn-primary">Filter</button>
        </form>
        <form method="post" action="@Url.Action("ExportAgeReports", "Reports")">
            <input type="hidden" name="ageRange" value="@Context.Request.Query["ageRange"]" />
            <button type="submit" class="btn btn-secondary">üì§ Export CSV</button>
        </form>
    </div>

    @if (Model == null)
    {
        <div class="alert alert-warning">
            <strong>‚ö†Ô∏è No Data Available</strong>
            <p>No age report data is currently available.</p>
        </div>
    }
    else if (!Model.Any())
    {
        <div class="alert alert-info">
            <strong>üìã No Answers Found</strong>
            <p>No answers were found for the selected filter.</p>
        </div>
    }
    else
    {
        <div class="report-table-container">
            <table class="report-table">
                <thead>
                    <tr>
                        <th>Age Range</th>
                        <th>Responses</th>
                        <th>Average</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>@item.AgeRange</td>
                            <td>@item.TotalResponses</td>
                            <td>@item.AverageScaleValueDisplay</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
</div>

<style>
    .reports-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }
    .report-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }
    .header-content {
        display: flex;
        flex-direction: column;
    }
    .btn-back {
        background-color: #6c757d;
        color: white;
        padding: 8px 16px;
        text-decoration: none;
        border-radius: 4px;
        border: none;
        cursor: pointer;
        font-size: 14px;
        transition: background-color 0.3s;
    }
    .btn-back:hover { background-color: #5a6268; color: white; }

    .filter-bar {
        display: flex;
        gap: 20px;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
    }
    .filter-form { display: flex; gap: 10px; align-items: center; }

    .report-table-container { overflow-x: auto; }
    .report-table { width: 100%; border-collapse: collapse; }
    .report-table th, .report-table td { padding: 12px; border-bottom: 1px solid #eaeaea; text-align: left; }
    .report-table th { background: #f8f9fa; }

    /* Percentage styles removed as percentage is no longer displayed */

    .btn { display: inline-block; padding: 8px 16px; border-radius: 4px; color: white; text-decoration: none; }
    .btn-primary { background: #3498db; }
    .btn-primary:hover { background: #2980b9; }
    .btn-secondary { background: #6c757d; }
    .btn-secondary:hover { background: #5a6268; }

    .alert { padding: 15px; margin: 20px 0; border-radius: 5px; border: 1px solid transparent; }
    .alert-warning { background-color: #fff3cd; border-color: #ffeaa7; color: #856404; }
    .alert-info { background-color: #d1ecf1; border-color: #bee5eb; color: #0c5460; }
</style>